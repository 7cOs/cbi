.total-opportunities
  h4(ng-if="list.pageName(['accounts']) || list.pageName(['target-list-detail'])" ng-hide="list.opportunitiesService.model.opportunities.length < 1") {{list.filtersService.model.appliedFilter.pagination.totalOpportunities | number:0 }} opportunities <span>across {{list.filtersService.model.appliedFilter.pagination.totalStores | number:0}} stores</span>
  //- h3(ng-if="list.pageName(['opportunities']) || !list.pageName(['target-list-detail'])" ng-hide="list.opportunitiesService.model.opportunities.length === 0") <strong>{{list.opportunitiesService.model.opportunitiesSum}} opportunities</strong> across {{list.opportunitiesService.model.opportunities.length}} stores

.action-buttons
  span(ng-switch="list.selected < 1")
    span(ng-switch-when="true")
      button.btn-action.disabled(ng-if="list.pageName(['target-lists', 'target-list-detail'])" ng-click="list.showDisabled('No opportunities are selected')") Add to Target List
      button.btn-action.disabled(ng-if="list.pageName(['opportunities'])" ng-click="list.showDisabled('No opportunities are selected')") Copy to Target List
      button.btn-action.disabled(ng-if="" ng-click="list.showDisabled('No opportunities are selected')") Delete
      button.btn-action.disabled(ng-click="list.showDisabled('No opportunities are selected')") Download
    span(ng-switch-when="false")
      md-menu(md-offset="0 45" ng-if="list.pageName(['target-lists', 'target-list-detail'])")
        button.btn-action(aria-label="Add to Target List" ng-click="$mdOpenMenu($event)" analytics-on="click" analytics-event="Add Opportunity") Add to Target List
        md-menu-content.target-list-menu
          md-menu-item(ng-repeat="targetList in list.userService.model.targetLists.owned" ng-click="list.addToTargetList(targetList.id)")
            p {{targetList.name}}
      button.btn-action(ng-class="{'disabled': list.selected < 1}" ng-if="list.pageName(['opportunities'])" analytics-on="click" analytics-event="Add to Target List") Copy to Target List
      button.btn-action(ng-if="" ng-click="list.removeOpportunity()") Delete
      button.btn-action(ng-disabled="list.selected < 1" ng-csv="list.flattenOpportunity(list.selected)" filename="opportunities.csv" csv-label="true") Download

button.icon.select-all(ng-class="{'disabled': list.isChecked()}" ng-click="list.isChecked() ? list.showDisabled('No opportunities are listed') : list.selectAllParents()") Select All

button.icon.narrow-icon.expand-all(ng-click="list.allOpportunitiesExpanded() ? list.showDisabled('All opportunities are expanded') : list.accordion.expandAll()" ng-class="{'disabled': list.allOpportunitiesExpanded()}") Expand All
button.icon.narrow-icon.collapse-all(ng-click="list.noOpportunitiesExpanded() ? list.showDisabled('No opportunities are expanded') : list.accordion.collapseAll()" ng-class="{'disabled': list.noOpportunitiesExpanded()}") Collapse All

p.list-disabled-message {{list.disabledMessage}}

v-accordion.styled-list(multiple="" id="opportunities" control="list.accordion" onexpand="list.expandCallback(item)" oncollapse="list.collapseCallback(item)" column='12' )
  div.header-row(row ng-class="{'header-disabled': list.filtersService.model.appliedFilter.pagination.totalOpportunities === 0}")
    div.checkbox-wrapper.placeholder
    div.hide-wrapper(ng-if="list.pageName()")
      label
    div.more-wrapper(ng-if="!list.pageName()")
    div.checkbox-sibling(column='12')
      div(column='3')
        label(ng-click="list.sortBy('store')" ng-class="{ 'header-bold' : list.sortProperty === 'opportunity.store.name'}")
          | Store / Number
          span(ng-class="{ 'chevron-down-small' : list.storeChevron, 'chevron-up-small' : !list.storeChevron}").chevron-down-small
      div(column='4')
        label Address
      div(column='2')
        label Opportunities
      div(column='1')
        label(ng-click="list.sortBy('depletions')" ng-class="{ 'header-bold' : list.sortProperty === 'depletionsCurrentYearToDate'}")
          | Depletions CYTD
          span(ng-class="{ 'chevron-down-small' : !list.depletionsChevron, 'chevron-up-small' : list.depletionsChevron}").chevron-down-small
      div(column='1')
        label vs Ya%
      div(column='1')
        label(ng-click="list.sortBy('segmentation')" ng-class="{ 'header-bold' : list.sortProperty === 'segmentation'}")
          | Segmentation
          span(ng-class="{ 'chevron-down-small' : !list.segmentationChevron, 'chevron-up-small' : list.segmentationChevron}").chevron-down-small
  div(ng-if="list.opportunitiesService.model.noOpportunitiesFound === true").no-opportunites
    h4 No Opportunities have been added yet
    p Try Searching for <span>Opportunities</span> and add them to your list
  v-pane.list-item(row ng-repeat="opportunity in list.opportunitiesService.model.opportunities" expanded='opportunity.isExpanded')
    .shadow-wrap.bottom
      div.checkbox-wrapper(ng-click="list.selectAllOpportunities(opportunity, list.selected)")
        md-checkbox(aria-label="Select Item" ng-checked="opportunity.selectedOpportunities === opportunity.groupedOpportunities.length")
      v-pane-header.checkbox-sibling(column='12')
        div.cell-parent
          div.pad-cell(column='3') {{::opportunity.store.name | titlecase}} <span class="supporting-text">\#{{::opportunity.store.storeNumber | uppercase}}</span>
          div.address(column='4') {{::opportunity.store.address | titlecase}}
          div(column='2') {{::opportunity.groupedOpportunities.length}} <span class="supporting-text">({{::opportunity.highImpactSum}} High)</span>
          .text-center(column='1') {{::opportunity.store.depletionsCurrentYearToDate | number }}
          .text-center(column='1' ng-class="opportunity.store.depletionsCurrentYearToDateYA >= 0 ? 'positive' : 'negative'").bold <span ng-if="opportunity.store.depletionsCurrentYearToDateYA >= 0 | number:2">+</span>{{opportunity.store.depletionsCurrentYearToDateYA | number:2}}<span>%</span>
          .text-center(column='1') {{::opportunity.store.segmentation}}
      v-pane-content(column='12' class="products" ng-class="{'open' : open}")
        .shadow-wrap.top
          .hero-row(row)
            div(column='3').pad-cell.brand-icons
              div
                img(ng-if='list.displayBrandIcon(opportunity.brands, "corona")' src='assets/img/brands/brand-lg-coronaextra.svg')
                img(ng-if='list.displayBrandIcon(opportunity.brands, "corona light")' src='assets/img/brands/brand-lg-coronalite.svg')
                img(ng-if='list.displayBrandIcon(opportunity.brands, "modelo")' src='assets/img/brands/brand-lg-modelo.svg')
                img(ng-if='list.displayBrandIcon(opportunity.brands, "negra modelo")' src='assets/img/brands/brand-lg-negramodelo.svg')
                img(ng-if='list.displayBrandIcon(opportunity.brands, "brand")' src='assets/img/brands/brand-lg-modelolite.svg')
              div.small-icons
                //- img(ng-if='!list.displayBrandIcon(opportunity.brands, "corona")' src='assets/img/brands/brand-sm-coronaextra.svg')
                img(ng-if='!list.displayBrandIcon(opportunity.brands, "corona light")' src='assets/img/brands/brand-sm-coronalite.svg')
                img(ng-if='!list.displayBrandIcon(opportunity.brands, "ballast point")' src='assets/img/brands/brand-sm-ballastpoint.svg')
                img(ng-if='!list.displayBrandIcon(opportunity.brands, "modelo chelada")' src='assets/img/brands/brand-sm-modelochelada.svg')
                img(ng-if='!list.displayBrandIcon(opportunity.brands, "brand")' src='assets/img/brands/brand-sm-modelolite.svg')
                img(ng-if='!list.displayBrandIcon(opportunity.brands, "negra modelo")' src='assets/img/brands/brand-sm-negramodelo.svg')
                img(ng-if='!list.displayBrandIcon(opportunity.brands, "pacifico")' src='assets/img/brands/brand-sm-pacifico.svg')
                img(ng-if='!list.displayBrandIcon(opportunity.brands, "pacifico light")' src='assets/img/brands/brand-sm-pacificolite.svg')
                img(ng-if='!list.displayBrandIcon(opportunity.brands, "tecate")' src='assets/img/brands/brand-sm-tecate.svg')
            div(column='3').no-pad
              label.bold Distribution L90
              div(row)
                div(column='4')
                  label Simple
                  div(row)
                    div(column='12') {{::opportunity.store.distributionL90Simple | number:0}}<span class="percentage">{{::opportunity.store.distributionL90SimpleYA | number:1}}</span>%
                div(column='8')
                  label Effective
                  div(row)
                    div(column='12') {{::opportunity.store.distributionL90Effective | number:0}}<span class="percentage">{{::opportunity.store.distributionL90EffectiveYA | number:1}}</span>%
            div(column='2')
              label Velocity (VS YA%)
              div(row)
                div(column='12') {{::opportunity.store.velocity | number:0}}<span class="percentage">{{::opportunity.store.velocityYA | number:1}}</span>%
            div(column='2')
              label Distributor
              div(row)
                div(column='12') {{::opportunity.store.distributors[0] | titlecase}}
            div(column='2')
              a(href="#").details-link.accent Full Details
        .title-row(row)
          div(column='1') &nbsp;
          div(column='2')
            label.bold Product
          div(column='2')
            label.bold Type
          div(column='4')
            label.bold Rationale
          div(column='1')
            label.bold Status
          div(column='1')
            label.bold Impact
          div(column='1')
            label.bold Dismiss
        v-accordion(multiple class="nested-accordion")
          v-pane.styled-list(ng-repeat="product in opportunity.groupedOpportunities")
            v-pane-header
              .action-overlay(ng-class="{'active': list.opportunityShared && product.id === list.currentOpportunityId, 'fail': list.shareOpportunityFail && product.id === list.currentOpportunityId}" ng-click="$event.stopPropagation()")
                div.checkbox-wrapper
                  md-checkbox(aria-label="Action Item Select" ng-checked="true")
                div.overlay-wrapper
                  p(ng-if="list.opportunityShared") Successfully sent to {{list.sharedCollaborators.length}} {{list.sharedCollaborators.length === 1 ? 'person' : 'people'}}
                  p(ng-if="list.shareOpportunityFail") Whatever you just tried didn't work
                div(ng-click="list.currentOpportunityId = ''").hide-wrapper.hide-icon-wrapper.hide-row
              div.cell-parent.sub-item(row)
                .regional-status(ng-if="product.regionalStatus")
                  div(class="{{product.regionalStatus}}")
                div(column='1').sub-item-select
                  md-checkbox(aria-label="Select Item" ng-click="list.selectOpportunity($event, opportunity, product, list.selected);" ng-checked="product.selected")
                div(column='2').pad-cell
                  span.product-title {{::product.product.brand}} <br>
                  | {{::product.product.name}}
                div.type(column='2') {{::product.type | formatOpportunitiesType}}
                div(column='4') {{::product.rationale}}
                div(column='1') {{::product.status}}
                div(column='1' class="impact {{product.impact}}")
                div(column='1').bottom.dismiss-product
                  div.more-wrapper
                    md-menu(md-position-mode="target-right target")
                      md-button.md-icon-button(aria-label="More" md-menu-origin ng-click="$mdOpenMenu($event)")
                        .more-icon
                      md-menu-content(width="4")
                        md-menu-item
                          p(ng-click="list.openShareModal(product.id); $pane.collapse()") Send To
                        md-menu-item
                          p(ng-click="list.openDismissModal(product.id); $pane.collapse()") Dismiss
            .shadow-wrap.top
              v-pane-content
                div(row)
                  div(column="1") &nbsp;
                  div(column="4").pad-cell
                    label Last Depletion
                    span(ng-if='product.lastDepletionDate === null') &ndash;
                    span(ng-if='product.lastDepletionDate !== null') {{::product.lastDepletionDate | timeAgo: 'daysOnly' }} <span class="depletion-date">{{::product.lastDepletionDate | date}}</span>
                  div(column="2")
                    label Depletions CYTD
                    span {{::product.depletionsCurrentYearToDate | number }}
                  div(column="2")
                    .tooltip-wrap
                      label vs YA %
                        .tooltip
                          img(src="../assets/img/icons/help-tooltip.svg")
                          md-tooltip(md-direction="bottom")
                            label Opportunity List
                            h3 vs YA %
                            p Monthly velocity for this account, calculated by taking the total volume over the selected time period (e.g. L90) and dividing by number of 30 day periods (3). “% vs YA” indicates the trend of velocity this year vs. same time period last year.
                    span {{::product.depletionsCurrentYearToDateYA}}
page
