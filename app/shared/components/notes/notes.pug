div.modal.notes(ng-if="notesOpen")
  div.title
    a.hide-row(ng-click="n.notesClose()")
    h4 {{::n.storeName | titlecase}}
  div.no-notes(ng-if="n.notes.length <= 0 && !n.loading" ng-hide="n.creatingNote")
    h5 There are no notes for this <br />account yet.
    button(ng-click="n.openCreateNote()").btn-action + Add A New Note
    br
    img(src="../assets/img/icons/no-notes.svg").no-notes-image
  div(ng-if="n.loading").progress-container
    md-progress-circular(ng-if="n.loading" md-mode="indeterminate" md-diameter="100").md-accent
    h5 Loading...

  div(ng-if="n.fileUploading").progress-container.uploader
    md-progress-circular(ng-if="n.fileUploading" md-mode="indeterminate" md-diameter="100").md-accent
    h5 Uploading...
  div.note-container(ng-if="n.notes.length > 0 && !n.fileUploading || n.creatingNote")
    div.new-note
      p(ng-click="n.openCreateNote()").bold.add-note <span>+</span> New Note
      div(ng-if="n.creatingNote").create-new-note
        label Topic
        .dropdown-filter
          .dropdown
            md-select(ng-model="n.newNote.title" aria-label="rationale dropdown" placeholder="Select a topic").short
              md-option(ng-repeat="topic in n.noteTopics" aria-label="note title selector" value="{{topic}}") {{topic}}
              md-option(aria-label="note title selector" ng-value="" ng-click="n.showInput()") + Add a new topic >
        input(ng-if="n.inputToggle" ng-model="n.newNote.title")
        label details
        div.text-editor
          text-angular(ta-toolbar="[['bold','italics', 'underline', 'ul']]" ta-text-editor-class="form-content" ng-model="n.newNote.body").text-editor
        //- TODO to uncomment when this feature is added
        //- div
        //-   .add-attachments(ngf-select="n.uploadFiles($files)" multiple accept="image/*")
        //-     a(href="#").accent Add an attachment
        //-     p {{n.errorMsg}}
        button(ng-click="n.createNote(n.newNote)").btn-action Save
        p(ng-click="n.cancelNewNote(n.newNote)").cancel.accent X Cancel
    div.note-body(ng-repeat="note in n.notes | orderBy:'-date'")
      div(ng-if="note.deleteConfirmation").delete-confirm
        h4 Are you sure you want to delete this note?
        div.buttons
          button(ng-click="n.deleteNote(note)").btn-action Yes
          p(ng-click="n.toggleDelete(note)").cancel.accent X Cancel
      div.note-body-field(ng-if="!note.deleteConfirmation")
        h4(ng-if="!note.editMode") {{note.title}} <span ng-if="note.attachments.length" class="attachments"></span>
        p(ng-if="!note.editMode" ng-class="{'long-note': note.noteDetails}") <div.note-body-field-text ta-bind ng-model="note.body"></div> <span class="read-more" ng-if="!note.noteDetails && note.body.length >= 150" ng-click="n.readMore(note)")>...Read More</span>
        //- .note-attachments(ng-if="note.noteDetails")
        //-   div.attachement-header
        //-     .attachments
        //-       p.accent Attachments
        //-     .download-all
        //-       a(href="#") Download All
        //-   ul
        //-     li(ng-repeat="attachment in note.attachments")
        //-       div.attached-files
        //-         .photo
        //-           img.thumbnail(src="{{attachment.url}}")
        //-           p.file-name <a ng-href="{{attachment.url}}" target="_self">{{attachment.fileName}}</a>&nbsp;{{attachment.fileSize}}
        //-           div(ng-click="n.showImage(attachment)" ng-class="{'chevron-down': !attachment.visible, 'chevron-up': attachment.visible}")
        //-           img(src="{{attachment.url}}" ng-if="attachment.visible")
          div
            .add-attachments(ng-if="note.author === 'Me'" ngf-select="n.uploadFiles($files)" multiple accept="image/*")
              p Add an attachment
              p {{n.errorMsg}}
        .note-body-footer(ng-if="!note.editMode")
          p by <span class="note-author"> {{note.author}}</span>  <span class="note-date">{{note.date | date:"dd MMMM, yyyy 'at' h:mm a"}}</span>
          .icons
            .delete-note(ng-if="note.author === 'Me'" ng-click="n.toggleDelete(note)")
            .edit-note(ng-if="note.author === 'Me'" ng-click="n.isEditing(note)" ng-class="{'edit-note': !note.editMode, 'edit-note-active': note.editMode}")
            .email-note(ng-click="n.mailNote(note)")
        div.notes-editing(ng-if="note.editMode")
          div.main-note-section
            div
              label Topic
              .dropdown-filter
                .dropdown
                  md-select(ng-model="note.title" aria-label="rationale dropdown" placeholder="Select a topic").short
                    md-option(aria-label="note title selector" value="{{option}}" ng-model="note.title" ng-repeat="option in n.noteTopics") {{option}}
                    md-option(aria-label="note title selector" value="" ng-click="n.showInput()") + Add a new topic >
              input(ng-if="n.inputToggle" ng-model="note.title")

            label Details
            div.text-editor
              text-angular(ta-toolbar="[['bold','italics', 'underline', 'ul']]" ng-model="note.body").text-editor
            //- div.inline-container
            //-   .attachments
            //-     p.accent Attachments
            //-   .download-all
            //-     p Download All
            //- ul
              li(ng-repeat="attachment in n.attachments")
                div.attached-files
                  .photo(ng-if="attachment.fileType === 'PNG'")
                    img.thumbnail(src="{{attachment.thumbnail}}")
                    p.file-name {{attachment.name}}&nbsp;({{attachment.fileSize}})
                    div(ng-click="n.showImage(attachment)" ng-class="{'chevron-down': !attachment.visible, 'chevron-up': attachment.visible}")
                    img(src="{{attachment.url}}" ng-if="attachment.visible")
                  .spreadsheet(ng-if="attachment.fileType === 'XLS'")
                    img.thumbnail(src="../assets/img/icons/download-xls-c.svg")
                    p.file-name {{attachment.name}}&nbsp;({{attachment.fileSize}})
                  .video(ng-if="attachment.fileType === 'MP4'")
                    img.thumbnail(src="../assets/img/icons/download-mov-c.svg")
                    p.file-name {{attachment.name}}&nbsp;({{attachment.fileSize}})
                  .audio(ng-if="attachment.fileType === 'MP3'")
                    img.thumbnail(src="../assets/img/icons/download-mp3-c.svg")
                    p.file-name {{attachment.name}}&nbsp;({{attachment.fileSize}})
                  .other(ng-if="attachment.fileType === 'OTHER'")
                    img.thumbnail(src="../assets/img/icons/download-other-c.svg")
                    p.file-name {{attachment.name}}&nbsp;({{attachment.fileSize}})
                  .pdf(ng-if="attachment.fileType === 'PDF'")
                    img.thumbnail(src="../assets/img/icons/download-pdf-c.svg")
                    p.file-name {{attachment.name}}&nbsp;({{attachment.fileSize}})
                  .powerpoint(ng-if="attachment.fileType === 'PPT'")
                    img.thumbnail(src="../assets/img/icons/download-ppt-c.svg")
                    p.file-name {{attachment.name}}&nbsp;({{attachment.fileSize}})
                  .zip(ng-if="attachment.fileType === 'ZIP'")
                    img.thumbnail(src="../assets/img/icons/download-zip-c.svg")
                    p.file-name {{attachment.name}}&nbsp;({{attachment.fileSize}})
                  .document(ng-if="attachment.fileType === 'DOC'")
                    img.thumbnail(src="../assets/img/icons/download-doc-c.svg")
                    p.file-name {{attachment.name}}&nbsp;({{attachment.fileSize}})
            div
              .add-attachments(ng-if="note.author === 'Me'" ngf-select="n.uploadFiles($files)" multiple accept="image/*")
                p Add an attachment
                p {{n.errorMsg}}
            button(ng-click="n.saveEditedNote(note)").btn-action Save
            p(ng-click="n.isEditing(note)").cancel.accent X Cancel
